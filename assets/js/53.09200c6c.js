(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{416:function(e,t,s){"use strict";s.r(t);var r=s(10),a=Object(r.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"_2-2-multi-server-support-多服务器支持"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-multi-server-support-多服务器支持"}},[e._v("#")]),e._v(" 2.2. Multi-server support 多服务器支持")]),e._v(" "),t("h2",{attrs:{id:"support-a-new-server-增加新的服务器支持"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#support-a-new-server-增加新的服务器支持"}},[e._v("#")]),e._v(" Support a new server 增加新的服务器支持")]),e._v(" "),t("h3",{attrs:{id:"gui"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#gui"}},[e._v("#")]),e._v(" GUI")]),e._v(" "),t("p",[e._v("Copy "),t("code",[e._v("./module/config/argparser.py")]),e._v(" to "),t("code",[e._v("argparser_xx.py")]),e._v(" and change the argment.")]),e._v(" "),t("p",[e._v("Create a dictionary in "),t("code",[e._v("./module/config/dictionary.py")]),e._v(" that translate your language to english.")]),e._v(" "),t("p",[e._v("Copy "),t("code",[e._v("alas_cn.py")]),e._v(" to "),t("code",[e._v("alas_xx.py")]),e._v(" and import  "),t("code",[e._v("argparser_xx.py")]),e._v(" . Then, edit server name.")]),e._v(" "),t("blockquote",[t("p",[e._v("Format of .pyw file name: <sctipt_name>_<server_name>.pyw")]),e._v(" "),t("p",[e._v("Script name is used to load ini file under "),t("code",[e._v("./config")]),e._v(", For example, alas_cn.pyw and alas_en.pyw both loads "),t("code",[e._v("./config/alas.ini")]),e._v(", but in different languages.")])]),e._v(" "),t("h3",{attrs:{id:"assets"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#assets"}},[e._v("#")]),e._v(" Assets")]),e._v(" "),t("p",[e._v("Copy folder "),t("code",[e._v("./assets/cn")]),e._v(" to "),t("code",[e._v("./assets/<your server>")]),e._v(", and replace the image. This will cost a lot of time to find, crop and test. Fortunately, if a image does not contain any charactors, it may works in all servers.")]),e._v(" "),t("p",[e._v("Add server name to dev_tools/button_extract.py "),t("code",[e._v("VALID_SERVER = ['cn', 'en', 'jp']")]),e._v(".")]),e._v(" "),t("p",[e._v("After replacing an image, don't forget to run "),t("code",[e._v("./dev_tools/button_extract.py")])]),e._v(" "),t("h3",{attrs:{id:"class-methods"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#class-methods"}},[e._v("#")]),e._v(" Class methods")]),e._v(" "),t("p",[e._v("Some method may be different in different servers. This decoractor is use to calls different function with a same name according to config (AzurLaneConfig instance).")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("from module.base.decorator import Config\nfrom module.base.base import ModuleBase\n\nclass AnotherModule(ModuleBase):\n    @Config.when(SERVER='en')\n    def function(self):\n        # This method will be called only in EN server\n        pass\n\n    @Config.when(SERVER=None)\n    def function(self):\n        # This method will be called in other server\n        pass\n")])])]),t("p",[t("strong",[e._v("OCR")])]),e._v(" "),t("p",[e._v("There area also some modules difficult to change: the commission module.")]),e._v(" "),t("p",[e._v("In "),t("code",[e._v("./module/reward/commission.py")]),e._v(", I use "),t("a",{attrs:{href:"https://github.com/breezedeus/cnocr",target:"_blank",rel:"noopener noreferrer"}},[e._v("cnocr"),t("OutboundLink")],1),e._v(" to recognize commission name in chinese, it may not works well in other languages.")]),e._v(" "),t("h2",{attrs:{id:"set-server-设置服务器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#set-server-设置服务器"}},[e._v("#")]),e._v(" Set server 设置服务器")]),e._v(" "),t("p",[e._v("这段代码所设置的服务器，将在全局生效。未设置服务器时，默认为 "),t("code",[e._v("cn")]),e._v("。")]),e._v(" "),t("p",[e._v("可以设置的服务器有 "),t("code",[e._v("cn")]),e._v("，"),t("code",[e._v("en")]),e._v("，"),t("code",[e._v("jp")]),e._v("。")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("import module.config.server as server\nserver.server = 'cn'  # Edit your server here.\n")])])]),t("blockquote",[t("p",[t("strong",[e._v("注意")])]),e._v(" "),t("p",[e._v("你需要在导入任意 Alas 模块之前设置服务器。在模块导入时，就会读取服务器设置，如果服务器设置晚于模块导入，设置不生效。")])]),e._v(" "),t("p",[e._v("使用例子：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("import numpy as np\nfrom tqdm import tqdm\n\nimport module.config.server as server\n\nserver.server = 'cn'  # Edit your server here.\n\nfrom module.logger import logger\nfrom module.statistics.battle_status import BattleStatusStatistics\nfrom module.statistics.get_items import GetItemsStatistics\nfrom module.statistics.utils import *\n")])])]),t("h2",{attrs:{id:"timezone-awareness-考虑时区"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#timezone-awareness-考虑时区"}},[e._v("#")]),e._v(" Timezone awareness 考虑时区")]),e._v(" "),t("p",[e._v("一些用户可能不与服务器在同一时区，所以不能简单地使用本地时间或本地日期。")]),e._v(" "),t("p",[e._v("以下是一些服务器的时区：")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("Server")]),e._v(" "),t("th",[e._v("Timezone")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("CN")]),e._v(" "),t("td",[e._v("UTC+8")])]),e._v(" "),t("tr",[t("td",[e._v("EN")]),e._v(" "),t("td",[e._v("UTC-7")])]),e._v(" "),t("tr",[t("td",[e._v("JP")]),e._v(" "),t("td",[e._v("UTC+9")])])])]),e._v(" "),t("p",[e._v("在 module/config/config.py 类 AzurLaneConfig 中有处理时区的函数。")]),e._v(" "),t("h3",{attrs:{id:"get-server-timezone-self"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#get-server-timezone-self"}},[e._v("#")]),e._v(" get_server_timezone(self)")]),e._v(" "),t("p",[e._v("返回当前服务器的时区。")]),e._v(" "),t("h3",{attrs:{id:"get-server-last-update-self-since"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#get-server-last-update-self-since"}},[e._v("#")]),e._v(" get_server_last_update(self, since)")]),e._v(" "),t("p",[e._v("返回服务器上次刷新时，所对应的本地时间。这个时间可以直接与本地时间进行比较。"),t("code",[e._v("since")]),e._v(" 是含有一个或多个元素的集合，表示服务器在一天内刷新的整点时间。")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v(">>> # 2020-06-06 12:56:45 UTC+2\n>>> import module.config.server as server\n>>> server.server = 'en'\n>>> from module.config.config import AzurLaneConfig\n>>> cfg = AzurLaneConfig()\n>>> cfg.get_server_last_update(since=(0,))\n2020-06-06 09:00:00\n")])])])])}),[],!1,null,null,null);t.default=a.exports}}]);